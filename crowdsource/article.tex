\documentclass[wcp]{jmlr}

\usepackage{enumerate}
\usepackage{bbold}
\usepackage{booktabs}
\usepackage{natbib}
\usepackage[utf8]{inputenc}
\usepackage[super]{nth}
\setlength{\textfloatsep}{15pt}

\usepackage{algorithm}
\usepackage{algorithmic}

\jmlryear{2014}
\jmlrworkshop{Neural Connectomics Workshop}

\title{Simple connectome inference from partial correlation statistics in calcium imaging}

  \author{\Name{Antonio Sutera},
   \Name{Arnaud Joly},
   \Name{Vincent FranÃ§ois-Lavet}, \Email{a.sutera@ulg.ac.be}\\
   \Name{Zixiao Aaron Qiu},
   \Name{Gilles Louppe},
   \Name{Damien Ernst}\and\Name{Pierre Geurts}
    \\
   \addr Department of EE and CS \& GIGA-R, University of Li\`ege, Belgium}

\begin{document}

\section{A large variety of performing methods}

\emph{
In the Results section "A large variety of performing methods", we intend to
assemble together various layman presentations of different approaches. If you
could provide a short popular-science style description of your approach (and
specifically of what you consider their main characterizing ingredients,
INVERSE COVARIANCE for you) this would be very helpful for me.  Here is not
really an issue of being precise, but of commenting substantial elements to a
public of... ignorant biologists! What's the logic of making a certain step?
How does the method work in a nutshell, without using equations but expressed
in plain words, etc. ? Then, based on all the texts I will collect from you, I
would build the section and let you edit it to correct mistakes or add
precisions.\\}


A partial correlation approach \cite{sutera2014simple}  is a simple yet
effective solution to the problem of connectome inference from calcium imaging
data. This partial correlation statistics, equivalent to the inverse of the correlation
measure, has  the property to filter out indirect associations between neurons and
only gives a high degree of association between directly connected neurons. The
winning solution of the Connectomics challenge combines two main steps:
(i) A pre-processing of the data using signal processing filters; and (ii)
The inference of the network through partial correlation. The pre-processing procedure
highly improves the infered network quality by filtering out noise and taking into account
specifities of the fluorecense signals.


\section{Method}
\emph{A second mini-text I ask you will converge to the Methods section. Here I need
a more detailed presentation of your method. However, it has to be precise, but
still understandable for a biologist. A bit like a recipe in a cookbook for
beginners.\\}

The inference problem reduced to its simplest shape is the identification of
neuron pairs that are directly connected in the network. Intuitively, such
pairs should be related somehow and in particular their activities have to be
similar since their are dependent on the connectivity network. Therefore a way
to identify them is to measure, or at least estimate, how closely related two
neurons are regarding their activities. The most common measure for that
purpose is the (Pearson) correlation.  However, correlation also measures the
degree of association between neurons that are connected through others and so
connected indirectly. It means all related neurons are found but direct pairs
are indistinguishable from indirect ones.

A variant of this classic approach is the partial correlation
\citep{sutera2014simple}, also known as the inverse of the correlation, which
measures the degree of association between two neurons taking into account the
state of all other neurons. Under technical assumptions, the inverse
correlation can be interpreted as a measure of association between directly
connected pairs of neurons and filter out indirectly connected pairs of
neurons. In genetics network, partial correlation have already shown to be
effective way to infer gene regulatory networks
\citep{de2004discovery,Schafer:2005}. This approach is fully described in
\cite{sutera2014simple} and is presented in Algorithm~\ref{alg:inverse-
covariance- pseudocode}. We first describe the pre-processing of the signal,
then explained how to compute the partial  correlation statistics.


Under the simplifying assumption that neurons are on-off units, characterised
by short periods of intense activity, or peaks, and longer periods of
inactivity, the first part of our algorithm consists of cleaning the raw
fluorescence data. More specifically, time-series are processed using standard
signal processing filters in order to : (i) remove noise mainly due to
fluctuations independent of calcium, calcium fluctuations independent of
spiking activity, calcium fluctuations in nearby tissues that have been
mistakenly captured, or simply by the imaging process ; (ii) to account for
fluorescence low decay ; and (iii) to reduce the importance of high global
activity in the network. This data pre-processing is standard  in the field of
signal processing \citep{kaiser1977data, oppenheim1983signals}.
The first step of our pipeline is to smooth the fluorescence signal by applying a low-pass filter for filtering out high frequency noise:
\begin{align}
f_1(x^t_i) &= x^{t-1}_i + x^t_i + x^{t+1}_i, \label{eq:symetric-median} \\
f_2(x^t_i) &= 0.4 x^{t-3}_i + 0.6 x^{t-2}_i + 0.8 x^{t-1}_i + x_i^t.
\label{eq:weighted-asymetric-median}
\end{align}

To have a signal that only has high magnitude around instances where the spikes occur, the second step of our pipeline transforms the time-series into its backward difference
\begin{align}
g(x^{t}_{i}) &= x^{t}_i - x^{t-1}_i. \label{eq:high-pass-filter}
\end{align}

To filter out small variations in the signal obtained after applying the
function $g$, as well as to eliminate negative values, we use the following
hard-threshold filter
\begin{align}\label{eqn:hfilter}
h(x^{t}_i) &= x^{t}_i \mathbb{1}(x^{t}_i \geq \tau) \text{ with } \tau > 0,
\end{align}
where $\tau$ is the threshold parameter and $\mathbb{1}$ is the indicator
function.

The objective of the last step of our filtering procedure is to decrease the
importance of spikes that occur when there is high global activity in the
network with respect to spikes that occur during normal activity. Indeed, we
have conjectured that when a large part of the network is firing, the rate at
which observations are made is not high enough to be able to detect
interactions, and that it would therefore be preferable to lower their
importance by changing their magnitude appropriately. Additionally, it is well-
known that neurons may also spike because of a high global activity
\citep{stetter2012model}. In such context, detecting pairwise neuron
interactions from the firing activity is meaningless. As such, the signal
output by h is finally applied to the following function
\begin{align}
 w(x^{t}_i) &= (x^{t}_i + 1 )^{1 + \frac{1}{\sum_{j} x^{t}_j}}, \label{eq:magnify-filter}
\end{align}
whose effect is to magnify the importance of spikes that occur in cases of low
global activity (measured by $\sum_j x^t_j$).

Under the assumption that fluorescence level neuron are jointly Gaussian,
\textit{partial correlation} thus measures conditional dependencies between
variables ; therefore it should naturally only detect direct associations
between neurons and filter out spurious indirect effects as mentioned before.

Practically speaking, the computation of all $p_{i,j}$ coefficients requires
the estimation of the covariance matrix $\Sigma$ and then computing its
inverse. Given that typically we have more samples than neurons, the covariance
matrix can be inverted in a straightforward way. We nevertheless obtained some
improvement by replacing the exact inverse with an approximation using only the
$M$ first principal components \citep{bishop2006pattern} (more details in
\citep{sutera2014simple}).

\begin{algorithm}[ht]
\begin{algorithmic}
 \algsetup{linenodelimiter= }

\STATE \textbf{Given} the sampled observation of $p$ neurons for $T$ time intervals.\\[2ex]

\FOR{$(f,\tau) \in (\{f_1, f_2\}, \{\tau_1, \tau_2, \dots \})$}

\STATE \vspace{1em} \textbf{Phase 1:} Apply the composed function $w \circ h \circ g \circ f$ to each fluorescent signal.
\FOR{$x \in \{1,\dots,T\} $}
\STATE $\bar{x}^t_i  \leftarrow w \circ h_{\tau} \circ g \circ f (x^t_i)$
\ENDFOR\\[2ex]

\STATE \textbf{Phase 2:} Compute \textit{Partial correlation} coefficient $p_{i,j}$ for each neuron pair $(i,j)$.
\FOR{all pair $(i,j)$}
\STATE Estimation of the covariance matrix $\Sigma$
\STATE Computing $\Sigma^{-1}$, the inverse of $\Sigma$
\STATE $p_{i,j} =
-\frac{\Sigma^{-1}_{ij}}{\sqrt{\Sigma^{-1}_{ii} \Sigma^{-1}_{jj}}}$

\ENDFOR\\[2ex]
\ENDFOR

\end{algorithmic}
\caption{Inverse covariance pseudo-code}
\label{alg:inverse-covariance-pseudocode}
\end{algorithm}





% \begin{algorithm}[h]
%  \KwData{Given the sampled observation $\{ x^t_i \in \mathbb{R} | i \in V, t = 1, \dots, T \}$ of $p$ neurons for T time intervals}
%  % \KwResult{how to write algorithm with \LaTeX2e }


%  \textbf{Phase 1:} Apply the composed function $w \circ h \circ g \circ f$ to each fluorescent signal.\;\;
% \ \ For


% {\Indp
%  \For{$x \in \{1,\dots,T\} $}{
% 		$\bar{x}^t_i  \leftarrow w \circ h \circ g \circ f (x^t_i)$
%  }
%  }

%  \While{not at end of this document}{
%   read current\;
%   \eIf{understand}{
%    go to next section\;
%    current section becomes this one\;
%    }{
%    go back to the beginning of current section\;
%   }
%  }
%  \caption{Inverse covariance pseudo-code}
%  \label{alg:inverse-covariance-pseudocode}
% \end{algorithm}


\newpage
\bibliography{references}

\end{document}
